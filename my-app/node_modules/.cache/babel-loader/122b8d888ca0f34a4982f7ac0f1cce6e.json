{"ast":null,"code":"// Defaultable APIs\n//\n// Copyright 2011 Iris Couch\n//\n//    Licensed under the Apache License, Version 2.0 (the \"License\");\n//    you may not use this file except in compliance with the License.\n//    You may obtain a copy of the License at\n//\n//        http://www.apache.org/licenses/LICENSE-2.0\n//\n//    Unless required by applicable law or agreed to in writing, software\n//    distributed under the License is distributed on an \"AS IS\" BASIS,\n//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n//    See the License for the specific language governing permissions and\n//    limitations under the License.\nmodule.exports = good_args(defaultable);\nmodule.exports.def = good_args(fresh_defaultable);\nmodule.exports.merge = merge_obj;\n\nvar path_lib = require('path');\n\nvar real_require = require;\n\nfunction fresh_defaultable(_mod, _defs, _definer) {\n  var mod = defaultable.apply(this, arguments);\n  mod.defaults._defaultable.fresh = true;\n  return mod;\n}\n\nfunction defaultable(real_module, initial_defs, definer) {\n  if (!real_module || !real_module.exports) throw new Error('Need to provide the module, with .exports object');\n  if (!is_obj(initial_defs)) throw new Error('Defaults must be an object'); // use real_module.id if filename not available (running on couchdb)\n\n  var mod_dir = path_lib.dirname(real_module.filename || real_module.id);\n  var mod_require = real_module.require || workaround_require;\n  workaround_require._defaultable = true;\n\n  function workaround_require(path) {\n    if (/^\\.\\//.test(path) || /^\\.\\.\\//.test(path)) path = path_lib.resolve(mod_dir, path);\n\n    try {\n      return real_require(path);\n    } catch (er) {\n      // This CouchDB workaround really belongs in CouchDB. CouchDB errors look like this:\n      //   [\"error\",\"invalid_require_path\",\"Must require a JavaScript string, not: object\"]\n      if (er[0] !== \"error\" || er[1] !== \"invalid_require_path\" || er[2] !== \"Must require a JavaScript string, not: object\") throw er;\n\n      try {\n        return real_require(path + '/index');\n      } catch (er2) {\n        throw er;\n      } // Nope, throw the original error.\n\n    }\n  }\n\n  var defaulter = make_defaulter({});\n  real_module.exports = defaulter(initial_defs);\n  return real_module.exports;\n\n  function make_defaulter(old_defs) {\n    defaulter._defaultable = {};\n    return defaulter;\n\n    function defaulter(new_defs) {\n      var faux_exports = {};\n      var faux_module = {\n        \"exports\": faux_exports\n      };\n      var final_defs = merge_obj(new_defs || {}, old_defs);\n      require._defaultable = true;\n\n      function require(path) {\n        var mod = mod_require.call(real_module, path);\n        if (mod.defaults && typeof mod.defaults === 'function' && mod.defaults._defaultable && !mod.defaults._defaultable.fresh) return mod.defaults(final_defs);\n        return mod;\n      }\n\n      definer(faux_module, faux_exports, final_defs, require);\n      var api = faux_module.exports;\n      if ('defaults' in api && !api.defaults._defaultable) throw new Error('defaultable modules may not export a label called \"defaults\"');else api.defaults = make_defaulter(final_defs);\n      return api;\n    }\n  }\n} // Recursively merge higher-priority values into previously-set lower-priority ones.\n\n\nfunction merge_obj(high, low) {\n  if (!is_obj(high)) throw new Error('Bad merge high-priority');\n  if (!is_obj(low)) throw new Error('Bad merge low-priority');\n  var keys = [];\n\n  function add_key(k) {\n    if (!~keys.indexOf(k)) keys.push(k);\n  }\n\n  _each(_keys(high), add_key);\n\n  _each(_keys(low), add_key);\n\n  var result = {};\n\n  _each(keys, function (key) {\n    var high_val = high[key];\n    var low_val = low[key];\n    if (is_obj(high_val) && is_obj(low_val)) result[key] = merge_obj(high_val, low_val);else if (key in high) result[key] = high[key];else if (key in low) result[key] = low[key];else throw new Error('Unknown key type: ' + key);\n  });\n\n  return result;\n} //\n// Utilities\n//\n\n/**\r\n * Added for browser compatibility\r\n */\n\n\nfunction _keys(obj) {\n  if (Object.keys) return Object.keys(obj);\n  var keys = [];\n\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) keys.push(k);\n  }\n\n  return keys;\n}\n\nfunction _each(obj, fn) {\n  for (var i = 0, len = obj.length; i < len; i++) {\n    fn(obj[i]);\n  }\n}\n\nfunction isArray(obj) {\n  if (Array.isArray) return Array.isArray(obj);\n  return toString.call(obj) === '[object Array]';\n}\n\nfunction good_args(func) {\n  // Make a function validate its parameters.\n  return good;\n\n  function good(_Mod, _Defs, _Definer) {\n    var args = Array.prototype.slice.call(arguments);\n    var m0dule = {\n      'exports': {}\n    };\n    if (args.length == 1) return func(m0dule, {}, args[0]);else if (args.length == 2) return func(m0dule, args[0], args[1]);else if (args.length > 2) return func.apply(this, args);else throw new Error('Unknown arguments: ' + JSON.stringify(args));\n  }\n}\n\nfunction is_obj(val) {\n  return val && !isArray(val) && typeof val === 'object';\n}","map":{"version":3,"names":["module","exports","good_args","defaultable","def","fresh_defaultable","merge","merge_obj","path_lib","require","real_require","_mod","_defs","_definer","mod","apply","arguments","defaults","_defaultable","fresh","real_module","initial_defs","definer","Error","is_obj","mod_dir","dirname","filename","id","mod_require","workaround_require","path","test","resolve","er","er2","defaulter","make_defaulter","old_defs","new_defs","faux_exports","faux_module","final_defs","call","api","high","low","keys","add_key","k","indexOf","push","_each","_keys","result","key","high_val","low_val","obj","Object","hasOwnProperty","fn","i","len","length","isArray","Array","toString","func","good","_Mod","_Defs","_Definer","args","prototype","slice","m0dule","JSON","stringify","val"],"sources":["C:/Users/Kamen/ML/AlgoTrader/node_modules/defaultable/defaultable.js"],"sourcesContent":["// Defaultable APIs\r\n//\r\n// Copyright 2011 Iris Couch\r\n//\r\n//    Licensed under the Apache License, Version 2.0 (the \"License\");\r\n//    you may not use this file except in compliance with the License.\r\n//    You may obtain a copy of the License at\r\n//\r\n//        http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n//    Unless required by applicable law or agreed to in writing, software\r\n//    distributed under the License is distributed on an \"AS IS\" BASIS,\r\n//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n//    See the License for the specific language governing permissions and\r\n//    limitations under the License.\r\n\r\nmodule.exports = good_args(defaultable);\r\nmodule.exports.def   = good_args(fresh_defaultable);\r\nmodule.exports.merge = merge_obj;\r\n\r\nvar path_lib = require('path');\r\nvar real_require = require;\r\n\r\n\r\nfunction fresh_defaultable(_mod, _defs, _definer) {\r\n  var mod = defaultable.apply(this, arguments);\r\n  mod.defaults._defaultable.fresh = true;\r\n  return mod;\r\n}\r\n\r\n\r\nfunction defaultable(real_module, initial_defs, definer) {\r\n  if(!real_module || !real_module.exports)\r\n    throw new Error('Need to provide the module, with .exports object');\r\n\r\n  if(!is_obj(initial_defs))\r\n    throw new Error('Defaults must be an object');\r\n\r\n  // use real_module.id if filename not available (running on couchdb)\r\n  var mod_dir = path_lib.dirname(real_module.filename || real_module.id);\r\n  var mod_require = real_module.require || workaround_require;\r\n\r\n  workaround_require._defaultable = true;\r\n  function workaround_require(path) {\r\n    if(/^\\.\\//.test(path) || /^\\.\\.\\//.test(path))\r\n      path = path_lib.resolve(mod_dir, path);\r\n\r\n    try       {\r\n      return real_require(path)\r\n    } catch(er) {\r\n      // This CouchDB workaround really belongs in CouchDB. CouchDB errors look like this:\r\n      //   [\"error\",\"invalid_require_path\",\"Must require a JavaScript string, not: object\"]\r\n      if(er[0] !== \"error\" || er[1] !== \"invalid_require_path\"\r\n      || er[2] !== \"Must require a JavaScript string, not: object\")\r\n        throw er;\r\n\r\n      try        { return real_require(path + '/index') }\r\n      catch(er2) { throw er                             } // Nope, throw the original error.\r\n    }\r\n  }\r\n\r\n  var defaulter = make_defaulter({});\r\n  real_module.exports = defaulter(initial_defs);\r\n  return real_module.exports;\r\n\r\n  function make_defaulter(old_defs) {\r\n    defaulter._defaultable = {};\r\n    return defaulter;\r\n\r\n    function defaulter(new_defs) {\r\n      var faux_exports = {};\r\n      var faux_module = {\"exports\":faux_exports};\r\n      var final_defs = merge_obj(new_defs || {}, old_defs);\r\n\r\n      require._defaultable = true;\r\n      function require(path) {\r\n        var mod = mod_require.call(real_module, path);\r\n        if(mod.defaults && typeof mod.defaults === 'function' && mod.defaults._defaultable && !mod.defaults._defaultable.fresh)\r\n          return mod.defaults(final_defs);\r\n        return mod;\r\n      }\r\n\r\n      definer(faux_module, faux_exports, final_defs, require);\r\n\r\n      var api = faux_module.exports;\r\n      if(('defaults' in api) && !api.defaults._defaultable)\r\n        throw new Error('defaultable modules may not export a label called \"defaults\"');\r\n      else\r\n        api.defaults = make_defaulter(final_defs);\r\n\r\n      return api;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// Recursively merge higher-priority values into previously-set lower-priority ones.\r\nfunction merge_obj(high, low) {\r\n  if(!is_obj(high))\r\n    throw new Error('Bad merge high-priority');\r\n  if(!is_obj(low))\r\n    throw new Error('Bad merge low-priority');\r\n\r\n  var keys = [];\r\n  function add_key(k) {\r\n    if(!~ keys.indexOf(k))\r\n      keys.push(k);\r\n  }\r\n\r\n  _each(_keys(high), add_key);\r\n  _each(_keys(low), add_key);\r\n\r\n  var result = {};\r\n  _each(keys, function (key) {\r\n    var high_val = high[key];\r\n    var low_val = low[key];\r\n\r\n    if(is_obj(high_val) && is_obj(low_val))\r\n      result[key] = merge_obj(high_val, low_val);\r\n    else if (key in high)\r\n      result[key] = high[key];\r\n    else if (key in low)\r\n      result[key] = low[key];\r\n    else\r\n      throw new Error('Unknown key type: ' + key);\r\n  })\r\n\r\n  return result;\r\n}\r\n\r\n\r\n//\r\n// Utilities\r\n//\r\n\r\n/**\r\n * Added for browser compatibility\r\n */\r\n\r\nfunction _keys(obj) {\r\n  if(Object.keys) return Object.keys(obj);\r\n  var keys = [];\r\n  for(var k in obj){\r\n    if(obj.hasOwnProperty(k)) keys.push(k);\r\n  }\r\n  return keys;\r\n}\r\n\r\nfunction _each(obj, fn) {\r\n  for (var i = 0, len = obj.length; i < len; i++) {\r\n    fn(obj[i]);\r\n  }\r\n}\r\n\r\nfunction isArray(obj) {\r\n  if(Array.isArray)\r\n    return Array.isArray(obj);\r\n  return toString.call(obj) === '[object Array]';\r\n}\r\n\r\nfunction good_args(func) {\r\n  // Make a function validate its parameters.\r\n  return good;\r\n\r\n  function good(_Mod, _Defs, _Definer) {\r\n    var args = Array.prototype.slice.call(arguments);\r\n    var m0dule = { 'exports': {} };\r\n\r\n    if(args.length == 1)\r\n      return func(m0dule, {}, args[0]);\r\n    else if(args.length == 2)\r\n      return func(m0dule, args[0], args[1]);\r\n    else if(args.length > 2)\r\n      return func.apply(this, args);\r\n    else\r\n      throw new Error('Unknown arguments: ' + JSON.stringify(args));\r\n  }\r\n}\r\n\r\nfunction is_obj(val) {\r\n  return val && !isArray(val) && (typeof val === 'object')\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}