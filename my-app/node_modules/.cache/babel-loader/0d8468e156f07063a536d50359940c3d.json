{"ast":null,"code":"'use strict';\n\nmodule.exports.disposer = disposer;\n\nfunction disposer(creatorFn, disposerFn, fn) {\n  const runDisposer = function (resource, result) {\n    let shouldThrow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return disposerFn(resource).then( // disposer resolved, do something with original fn's promise\n    () => {\n      if (shouldThrow) throw result;\n      return result;\n    }, // Disposer fn failed, crash process\n    err => {\n      throw err; // Or process.exit?\n    });\n  };\n\n  return creatorFn.then(resource => {\n    // fn(resource) can throw, so wrap in a promise here\n    return Promise.resolve().then(() => fn(resource)).then(result => runDisposer(resource, result)).catch(err => runDisposer(resource, err, true));\n  });\n}","map":{"version":3,"names":["module","exports","disposer","creatorFn","disposerFn","fn","runDisposer","resource","result","shouldThrow","then","err","Promise","resolve","catch"],"sources":["C:/Users/Kamen/ML/AlgoTrader/node_modules/cacache/lib/util/disposer.js"],"sourcesContent":["'use strict'\n\nmodule.exports.disposer = disposer\n\nfunction disposer (creatorFn, disposerFn, fn) {\n  const runDisposer = (resource, result, shouldThrow = false) => {\n    return disposerFn(resource)\n      .then(\n        // disposer resolved, do something with original fn's promise\n        () => {\n          if (shouldThrow)\n            throw result\n\n          return result\n        },\n        // Disposer fn failed, crash process\n        (err) => {\n          throw err\n          // Or process.exit?\n        })\n  }\n\n  return creatorFn\n    .then((resource) => {\n      // fn(resource) can throw, so wrap in a promise here\n      return Promise.resolve().then(() => fn(resource))\n        .then((result) => runDisposer(resource, result))\n        .catch((err) => runDisposer(resource, err, true))\n    })\n}\n"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,OAAP,CAAeC,QAAf,GAA0BA,QAA1B;;AAEA,SAASA,QAAT,CAAmBC,SAAnB,EAA8BC,UAA9B,EAA0CC,EAA1C,EAA8C;EAC5C,MAAMC,WAAW,GAAG,UAACC,QAAD,EAAWC,MAAX,EAA2C;IAAA,IAAxBC,WAAwB,uEAAV,KAAU;IAC7D,OAAOL,UAAU,CAACG,QAAD,CAAV,CACJG,IADI,EAEH;IACA,MAAM;MACJ,IAAID,WAAJ,EACE,MAAMD,MAAN;MAEF,OAAOA,MAAP;IACD,CARE,EASH;IACCG,GAAD,IAAS;MACP,MAAMA,GAAN,CADO,CAEP;IACD,CAbE,CAAP;EAcD,CAfD;;EAiBA,OAAOR,SAAS,CACbO,IADI,CACEH,QAAD,IAAc;IAClB;IACA,OAAOK,OAAO,CAACC,OAAR,GAAkBH,IAAlB,CAAuB,MAAML,EAAE,CAACE,QAAD,CAA/B,EACJG,IADI,CACEF,MAAD,IAAYF,WAAW,CAACC,QAAD,EAAWC,MAAX,CADxB,EAEJM,KAFI,CAEGH,GAAD,IAASL,WAAW,CAACC,QAAD,EAAWI,GAAX,EAAgB,IAAhB,CAFtB,CAAP;EAGD,CANI,CAAP;AAOD"},"metadata":{},"sourceType":"script"}