{"ast":null,"code":"// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\nvar dgram = require('dgram'),\n    EventEmitter = require('events').EventEmitter,\n    net = require('net'),\n    util = require('util');\n\nvar is_absolute = exports.is_absolute = function (f) {\n  return f && /\\.$/.test(f);\n};\n\nvar ensure_absolute = exports.ensure_absolute = function (f) {\n  if (!is_absolute(f)) return f += '.';\n  return f;\n};\n\nvar CNAME = require('native-dns-packet').consts.NAME_TO_QTYPE.CNAME;\n\nvar Lookup = exports.Lookup = function (store, zone, question, cb) {\n  if (!(this instanceof Lookup)) return new Lookup(store, zone, question, cb);\n  this.store = store;\n  this.zone = zone;\n  this.cb = cb;\n  this.question = question;\n  this.results = [];\n  this.wildcard = undefined;\n  this.name = ensure_absolute(question.name);\n  this.store.get(this.zone, this.name, this.lookup.bind(this));\n};\n\nLookup.prototype.send = function (err) {\n  this.cb(err, this.results);\n};\n\nLookup.prototype.lookup = function (err, results) {\n  var type,\n      ret,\n      name,\n      self = this;\n  if (err) return this.send(err);\n\n  if (!results) {\n    if (!this.wildcard) this.wildcard = this.question.name;\n    if (this.wildcard.toLowerCase() == this.zone.toLowerCase()) return this.send();\n    name = this.wildcard = this.wildcard.split('.').splice(1).join('.'); // 'com.'.split('.').splice(1) will return empty string, we're at the end\n\n    if (!this.wildcard) return this.send();\n    name = '*.' + name;\n  } else if (results[this.question.type]) {\n    type = this.question.type;\n    ret = results;\n  } else if (results[CNAME]) {\n    type = CNAME;\n    ret = results;\n    this.name = name = results[CNAME][0].data;\n  }\n\n  if (ret) {\n    ret = ret[type];\n    ret.forEach(function (r) {\n      var rr, k;\n\n      if (self.wildcard && /^\\*/.test(r.name)) {\n        rr = {};\n\n        for (k in r) {\n          rr[k] = r[k];\n        }\n\n        rr.name = self.name;\n      } else {\n        rr = r;\n      }\n\n      self.results.push(rr);\n    });\n  }\n\n  if (name) this.store.get(this.zone, ensure_absolute(name), this.lookup.bind(this));else this.send();\n};","map":{"version":3,"names":["dgram","require","EventEmitter","net","util","is_absolute","exports","f","test","ensure_absolute","CNAME","consts","NAME_TO_QTYPE","Lookup","store","zone","question","cb","results","wildcard","undefined","name","get","lookup","bind","prototype","send","err","type","ret","self","toLowerCase","split","splice","join","data","forEach","r","rr","k","push"],"sources":["C:/Users/Kamen/ML/AlgoTrader/node_modules/native-dns-cache/lookup.js"],"sourcesContent":["// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE\r\n\r\nvar dgram = require('dgram'),\r\n    EventEmitter = require('events').EventEmitter,\r\n    net = require('net'),\r\n    util = require('util');\r\n\r\nvar is_absolute = exports.is_absolute = function (f) {\r\n  return f && /\\.$/.test(f);\r\n};\r\n\r\nvar ensure_absolute = exports.ensure_absolute = function (f) {\r\n  if (!is_absolute(f))\r\n    return f += '.';\r\n  return f;\r\n};\r\n\r\nvar CNAME = require('native-dns-packet').consts.NAME_TO_QTYPE.CNAME;\r\n\r\nvar Lookup = exports.Lookup = function (store, zone, question, cb) {\r\n  if (!(this instanceof Lookup))\r\n    return new Lookup(store, zone, question, cb);\r\n\r\n  this.store = store;\r\n  this.zone = zone;\r\n  this.cb = cb;\r\n  this.question = question;\r\n  this.results = [];\r\n  this.wildcard = undefined;\r\n\r\n  this.name = ensure_absolute(question.name);\r\n\r\n  this.store.get(this.zone, this.name, this.lookup.bind(this));\r\n};\r\n\r\nLookup.prototype.send = function (err) {\r\n  this.cb(err, this.results);\r\n};\r\n\r\nLookup.prototype.lookup = function (err, results) {\r\n  var type, ret, name, self = this;\r\n\r\n  if (err)\r\n    return this.send(err);\r\n\r\n  if (!results) {\r\n    if (!this.wildcard)\r\n      this.wildcard = this.question.name;\r\n\r\n    if (this.wildcard.toLowerCase() == this.zone.toLowerCase())\r\n      return this.send();\r\n\r\n    name = this.wildcard = this.wildcard.split('.').splice(1).join('.');\r\n\r\n    // 'com.'.split('.').splice(1) will return empty string, we're at the end\r\n    if (!this.wildcard)\r\n      return this.send();\r\n\r\n    name = '*.' + name;\r\n  } else if (results[this.question.type]) {\r\n    type = this.question.type;\r\n    ret = results;\r\n  } else if (results[CNAME]) {\r\n    type = CNAME;\r\n    ret = results;\r\n    this.name = name = results[CNAME][0].data\r\n  }\r\n\r\n  if (ret) {\r\n    ret = ret[type];\r\n    ret.forEach(function (r) {\r\n      var rr, k;\r\n\r\n      if (self.wildcard && /^\\*/.test(r.name)) {\r\n        rr = {};\r\n        for (k in r) {\r\n          rr[k] = r[k];\r\n        }\r\n        rr.name = self.name;\r\n      } else {\r\n        rr = r;\r\n      }\r\n\r\n      self.results.push(rr);\r\n    });\r\n  }\r\n\r\n  if (name)\r\n    this.store.get(this.zone, ensure_absolute(name), this.lookup.bind(this));\r\n  else\r\n    this.send();\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}